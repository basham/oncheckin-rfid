<html>
<head>
	<title>Prototype</title>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script>
<script> 
	var socket = new io.Socket('localhost', { port: 3000 }); 
	socket.connect();
	socket.on('connect', function(){ message('Connected client-side') });
	socket.on('message', function(obj) {
		if ( 'message' in obj )
			message(obj.message);
		if ( 'data' in obj ) {
			for (var d in obj.data)
				data( obj.data[d] );
		}
	});
	socket.on('disconnect', function(){ });
	
	function message(msg) {
		$('#console').prepend('<li><em>' + msg + '</em></li>');
	}
	
	function data(d) {
		$('#console').prepend('<li>' + d + '</li>');
	}
	
	$(document).ready(function() {
		
		$('#btn').click(function() {
			message('Clearing');
			socket.send({ action: 'clear' });
		});
	
	});
	/*
	      function message(obj){
        var el = document.createElement('p');
        if ('announcement' in obj) el.innerHTML = '<em>' + esc(obj.announcement) + '</em>';
        else if ('message' in obj) el.innerHTML = '<b>' + esc(obj.message[0]) + ':</b> ' + esc(obj.message[1]);
        document.getElementById('chat').appendChild(el);
        document.getElementById('chat').scrollTop = 1000000;
      }
      
      function send(){
        var val = document.getElementById('text').value;
        socket.send(val);
        message({ message: ['you', val] });
        document.getElementById('text').value = '';
      }
      
      function esc(msg){
        return msg.replace(/</g, '&lt;').replace(/>/g, '&gt;');
      };
      
      var socket = new io.Socket(null, {port: 8080, rememberTransport: false});
      socket.connect();
      socket.on('message', function(obj){
        if ('buffer' in obj){
          document.getElementById('form').style.display='block';
          document.getElementById('chat').innerHTML = '';
          
          for (var i in obj.buffer) message(obj.buffer[i]);
        } else message(obj);
      });
*/

</script> 

</head>

<body>
	
<h1>Messages</h1>

<ol id="console"></ol>

<p><button id="btn">Clear</button></p>

</body>
</html>